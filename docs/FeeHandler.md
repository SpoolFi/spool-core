# FeeHandler





Implementation of the {IFeeHandler} interface.

*Handles fees generated by vaults. Fees are only collected when a user withdraws and calculated from the generated profit (performance fees). There are 4 type of fees: - Ecosystem fee: Circle back in Spool ecosystem and is distributed to Spool system participants - Treasury fee: Collected by the Spool DAO to support the development of the Spool - Risk provider fee: Collected the risk provider the vault is using to allocate it&#39;s funds - Vault owner fee: Collected by the vault owner (initially the vault creator, later can be transferred to another address)*

## Methods

### MAX_ECOSYSTEM_FEE

```solidity
function MAX_ECOSYSTEM_FEE() external view returns (uint256)
```

Maximum Ecosystem Fee (20%) 




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint256 | undefined

### MAX_RISK_PROVIDER_FEE

```solidity
function MAX_RISK_PROVIDER_FEE() external view returns (uint256)
```

Max Risk Provider Fee (5%)




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint256 | undefined

### MAX_TREASURY_FEE

```solidity
function MAX_TREASURY_FEE() external view returns (uint256)
```

Max Treasury Fee (10%)




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint256 | undefined

### collectEcosystemFees

```solidity
function collectEcosystemFees(contract IERC20[] tokens) external nonpayable
```

Collect ecosystem fees transfers any fees collected for the ecosystem fee collecter to them. callable by anyone, but only transfers to ecosystem fee collector address. see NOTE in {collectFees} for more details on internal logic.



#### Parameters

| Name | Type | Description |
|---|---|---|
| tokens | contract IERC20[] | token addresses for which fees have been collected in

### collectFees

```solidity
function collectFees(contract IERC20[] tokens) external nonpayable
```

Collect vault owner and risk provider fees

*transfers any fees collected for the sender to them. fees are only collected for the vault owner and risk providers. if it&#39;s called by anyone else it will have no effect. NOTE To save on storage fees, we use the value stored at collectedFees as a kind of boolean. if there are fees to be collected (value &gt; 1), we send the fees to the user, and then set the word as 1. the value must be greater than this to send fees again. Therefore only the first SSTORE is 20k and subsequent writes are 5k.*

#### Parameters

| Name | Type | Description |
|---|---|---|
| tokens | contract IERC20[] | token addresses for which fees have been collected in

### collectTreasuryFees

```solidity
function collectTreasuryFees(contract IERC20[] tokens) external nonpayable
```

Collect treasury fees transfers any fees collected for the treasury fee collecter to them. see NOTE in {collectFees} for more details on internal logic.



#### Parameters

| Name | Type | Description |
|---|---|---|
| tokens | contract IERC20[] | token addresses for which fees have been collected in

### collectedFees

```solidity
function collectedFees(address, contract IERC20) external view returns (uint256)
```

risk provider and vault owner collected fees



#### Parameters

| Name | Type | Description |
|---|---|---|
| _0 | address | undefined
| _1 | contract IERC20 | undefined

#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint256 | undefined

### controller

```solidity
function controller() external view returns (contract IController)
```

controller contract




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | contract IController | undefined

### ecosystemFee

```solidity
function ecosystemFee() external view returns (uint16)
```

Current Ecosystem Fee




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint16 | undefined

### ecosystemFeeCollector

```solidity
function ecosystemFeeCollector() external view returns (address)
```

Current Ecosystem Fee to the collector




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | address | undefined

### payFees

```solidity
function payFees(contract IERC20 underlying, uint256 profit, address riskProvider, address vaultOwner, uint16 vaultFee) external nonpayable returns (uint256 feesPaid)
```

Pay vault fees to ecosystem, treasury, risk provider and vault owner.

*Returns total fee size, that is later transfered by vault to this contract. Requirements: - caller must be a vault*

#### Parameters

| Name | Type | Description |
|---|---|---|
| underlying | contract IERC20 | token address for which fees are to be paid
| profit | uint256 | User realized profit
| riskProvider | address | address of the risk provider for which fees are to be paid
| vaultOwner | address | address of the owner of the calling vault, recipient of the vault fees
| vaultFee | uint16 | fee to owner in the calling vault

#### Returns

| Name | Type | Description |
|---|---|---|
| feesPaid | uint256 | total calculated fees paid from the user profit

### platformCollectedFees

```solidity
function platformCollectedFees(contract IERC20) external view returns (uint128 ecosystem, uint128 treasury)
```

ecosystem and treasury collected fees



#### Parameters

| Name | Type | Description |
|---|---|---|
| _0 | contract IERC20 | undefined

#### Returns

| Name | Type | Description |
|---|---|---|
| ecosystem | uint128 | undefined
| treasury | uint128 | undefined

### riskProviderFees

```solidity
function riskProviderFees(address) external view returns (uint16)
```

Risk provider fee size



#### Parameters

| Name | Type | Description |
|---|---|---|
| _0 | address | undefined

#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint16 | undefined

### riskProviderRegistry

```solidity
function riskProviderRegistry() external view returns (address)
```

risk provider registry contract




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | address | undefined

### setEcosystemCollector

```solidity
function setEcosystemCollector(address collector) external nonpayable
```

Set ecosystem fee collector address

*Requirements: - caller must be the spool owner*

#### Parameters

| Name | Type | Description |
|---|---|---|
| collector | address | ecosystem fee collector address to set

### setEcosystemFee

```solidity
function setEcosystemFee(uint16 fee) external nonpayable
```

Set ecosystem fee size

*Requirements: - caller must be the spool owner*

#### Parameters

| Name | Type | Description |
|---|---|---|
| fee | uint16 | ecosystem fee to set

### setRiskProviderFee

```solidity
function setRiskProviderFee(address riskProvider, uint16 fee) external nonpayable
```

Set risk provider fee size

*Requirements: - caller must be the risk provider registry*

#### Parameters

| Name | Type | Description |
|---|---|---|
| riskProvider | address | address to risk provider to set fee for
| fee | uint16 | fee to set for the risk provider

### setTreasuryCollector

```solidity
function setTreasuryCollector(address collector) external nonpayable
```

Set treasiry fee collector address

*Requirements: - caller must be the spool owner*

#### Parameters

| Name | Type | Description |
|---|---|---|
| collector | address | treasiry fee collector address to set

### setTreasuryFee

```solidity
function setTreasuryFee(uint16 fee) external nonpayable
```

Set treasury fee size

*Requirements: - caller must be the spool owner*

#### Parameters

| Name | Type | Description |
|---|---|---|
| fee | uint16 | treasury fee to set

### treasuryFee

```solidity
function treasuryFee() external view returns (uint16)
```

Current Treasury Fee




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | uint16 | undefined

### treasuryFeeCollector

```solidity
function treasuryFeeCollector() external view returns (address)
```

Current Treasury Fee to the collector




#### Returns

| Name | Type | Description |
|---|---|---|
| _0 | address | undefined




